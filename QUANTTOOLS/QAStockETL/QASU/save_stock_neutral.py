from QUANTAXIS.QAUtil import (QA_util_today_str,QA_util_log_info)
from QUANTTOOLS.QAStockETL.QAFetch import QA_fetch_stock_quant_data
from QUANTTOOLS.QAStockETL.QAUtil import QA_util_sql_store_mysql
from QUANTTOOLS.QAStockETL.QAFetch import QA_fetch_stock_all
import pandas as pd

def QA_etl_stock_quant_neut(start_date = QA_util_today_str(), end_date = QA_util_today_str(), ui_log= None):
    QA_util_log_info(
        '##JOB Now ETL STOCK QUANT DATA NEUTRAL ==== from {} to {}'.format(start_date, end_date), ui_log)
    code = QA_fetch_stock_all().code.unique().tolist()
    data = QA_fetch_stock_quant_data(code,start_date,end_date, block=False, norm_type='standardize').reset_index()
    data = data.assign(date=pd.to_datetime(data.date, format = '%Y-%m-%d'))
    index_col = ['date', 'code'] + ['VR',
                                    'VRSI',
                                    'VRSI_C',
                                    'VSTD',
                                    'BOLL',
                                    'UB',
                                    'LB',
                                    'WIDTH',
                                    'WR',
                                    'MR',
                                    'SR',
                                    'WS',
                                    'MS',
                                    'SS',
                                    'MIKE_WRSC',
                                    'MIKE_WRJC',
                                    'MIKE_WSSC',
                                    'MIKE_WSJC',
                                    'MIKE_TR',
                                    'MIKE_BOLL',
                                    'ASI',
                                    'ASIT',
                                    'OBV',
                                    'OBV_C',
                                    'VPT',
                                    'MAVPT',
                                    'VPT_CROSS1',
                                    'VPT_CROSS2',
                                    'VPT_CROSS3',
                                    'VPT_CROSS4',
                                    'KDJ_K',
                                    'KDJ_D',
                                    'KDJ_J',
                                    'KDJ_CROSS1',
                                    'KDJ_CROSS2',
                                    'WR1',
                                    'WR2',
                                    'WR_CROSS1',
                                    'WR_CROSS2',
                                    'ROC',
                                    'ROCMA',
                                    'RSI1',
                                    'RSI2',
                                    'RSI3',
                                    'RSI1_C',
                                    'RSI2_C',
                                    'RSI3_C',
                                    'RSI_CROSS1',
                                    'RSI_CROSS2',
                                    'CCI',
                                    'CCI_CROSS1',
                                    'CCI_CROSS2',
                                    'CCI_CROSS3',
                                    'CCI_CROSS4',
                                    'BIAS1',
                                    'BIAS2',
                                    'BIAS3',
                                    'BIAS_CROSS1',
                                    'BIAS_CROSS2',
                                    'OSC',
                                    'MAOSC',
                                    'OSC_CROSS1',
                                    'OSC_CROSS2',
                                    'OSC_CROSS3',
                                    'OSC_CROSS4',
                                    'ADTM',
                                    'MAADTM',
                                    'ADTM_CROSS1',
                                    'ADTM_CROSS2',
                                    'DIF',
                                    'DEA',
                                    'MACD',
                                    'CROSS_JC',
                                    'CROSS_SC',
                                    'MACD_TR',
                                    'DI1',
                                    'DI2',
                                    'ADX',
                                    'ADXR',
                                    'ADX_C',
                                    'DI_M',
                                    'DI_CROSS1',
                                    'DI_CROSS2',
                                    'ADX_CROSS1',
                                    'ADX_CROSS2',
                                    'DDD',
                                    'AMA',
                                    'DMA_CROSS1',
                                    'DMA_CROSS2',
                                    'MTM',
                                    'MTMMA',
                                    'MTM_CROSS1',
                                    'MTM_CROSS2',
                                    'MTM_CROSS3',
                                    'MTM_CROSS4',
                                    'BBI',
                                    'BBI_CROSS1',
                                    'BBI_CROSS2',
                                    'MFI',
                                    'MFI_C',
                                    'TR',
                                    'ATR',
                                    'ATRR',
                                    'RSV',
                                    'SKDJ_K',
                                    'SKDJ_D',
                                    'SKDJ_CROSS1',
                                    'SKDJ_CROSS2',
                                    'DDI',
                                    'ADDI',
                                    'AD',
                                    'DDI_C',
                                    'AD_C',
                                    'ADDI_C',
                                    'SHA_LOW',
                                    'SHA_UP',
                                    'BODY',
                                    'BODY_ABS',
                                    'PRICE_PCG',
                                    'MA3',
                                    'MA5',
                                    'MA8',
                                    'MA10',
                                    'MA12',
                                    'MA15',
                                    'MA20',
                                    'MA30',
                                    'MA35',
                                    'MA40',
                                    'MA45',
                                    'MA50',
                                    'MA60',
                                    'SHORT10',
                                    'SHORT20',
                                    'SHORT60',
                                    'LONG60',
                                    'SHORT_CROSS1',
                                    'SHORT_CROSS2',
                                    'LONG_CROSS1',
                                    'LONG_CROSS2',
                                    'LONG_AMOUNT',
                                    'SHORT_AMOUNT',
                                    'GMMA3',
                                    'GMMA5',
                                    'GMMA8',
                                    'GMMA10',
                                    'GMMA12',
                                    'GMMA30',
                                    'GMMA35',
                                    'GMMA40',
                                    'GMMA45',
                                    'GMMA50',
                                    'MA_VOL3',
                                    'MA_VOL5',
                                    'MA_VOL8',
                                    'MA_VOL10',
                                    'MA_VOL12',
                                    'MA_VOL15',
                                    'MA_VOL20',
                                    'MA_VOL30',
                                    'MA_VOL35',
                                    'MA_VOL40',
                                    'MA_VOL45',
                                    'MA_VOL50',
                                    'MA_VOL60',
                                    'SHORT10V',
                                    'SHORT20V',
                                    'SHORT60V',
                                    'LONG60V',
                                    'SHORTV_CROSS1',
                                    'SHORTV_CROSS2',
                                    'LONGV_CROSS1',
                                    'LONGV_CROSS2',
                                    'LONGV_AMOUNT',
                                    'SHORTV_AMOUNT',
                                    'GMMA_VOL3',
                                    'GMMA_VOL5',
                                    'GMMA_VOL8',
                                    'GMMA_VOL10',
                                    'GMMA_VOL12',
                                    'GMMA_VOL30',
                                    'GMMA_VOL35',
                                    'GMMA_VOL40',
                                    'GMMA_VOL45',
                                    'GMMA_VOL50',
                                    'CDL2CROWS',
                                    'CDL3BLACKCROWS',
                                    'CDL3INSIDE',
                                    'CDL3LINESTRIKE',
                                    'CDL3OUTSIDE',
                                    'CDL3STARSINSOUTH',
                                    'CDL3WHITESOLDIERS',
                                    'CDLABANDONEDBABY',
                                    'CDLADVANCEBLOCK',
                                    'CDLBELTHOLD',
                                    'CDLBREAKAWAY',
                                    'CDLCLOSINGMARUBOZU',
                                    'CDLCONCEALBABYSWALL',
                                    'CDLCOUNTERATTACK',
                                    'CDLDARKCLOUDCOVER',
                                    'CDLDOJI',
                                    'CDLDOJISTAR',
                                    'CDLDRAGONFLYDOJI',
                                    'CDLENGULFING',
                                    'CDLEVENINGDOJISTAR',
                                    'CDLEVENINGSTAR',
                                    'CDLGAPSIDESIDEWHITE',
                                    'CDLGRAVESTONEDOJI',
                                    'CDLHAMMER',
                                    'CDLHANGINGMAN',
                                    'CDLHARAMI',
                                    'CDLHARAMICROSS',
                                    'CDLHIGHWAVE',
                                    'CDLHIKKAKE',
                                    'CDLHIKKAKEMOD',
                                    'CDLHOMINGPIGEON',
                                    'CDLIDENTICAL3CROWS',
                                    'CDLINNECK',
                                    'CDLINVERTEDHAMMER',
                                    'CDLKICKING',
                                    'CDLKICKINGBYLENGTH',
                                    'CDLLADDERBOTTOM',
                                    'CDLLONGLEGGEDDOJI',
                                    'CDLLONGLINE',
                                    'CDLMARUBOZU',
                                    'CDLMATCHINGLOW',
                                    'CDLMATHOLD',
                                    'CDLMORNINGDOJISTAR',
                                    'CDLMORNINGSTAR',
                                    'CDLONNECK',
                                    'CDLPIERCING',
                                    'CDLRICKSHAWMAN',
                                    'CDLRISEFALL3METHODS',
                                    'CDLSEPARATINGLINES',
                                    'CDLSHOOTINGSTAR',
                                    'CDLSHORTLINE',
                                    'CDLSPINNINGTOP',
                                    'CDLSTALLEDPATTERN',
                                    'CDLSTICKSANDWICH',
                                    'CDLTAKURI',
                                    'CDLTASUKIGAP',
                                    'CDLTHRUSTING',
                                    'CDLTRISTAR',
                                    'CDLUNIQUE3RIVER',
                                    'CDLUPSIDEGAP2CROWS',
                                    'CDLXSIDEGAP3METHODS',
                                    'SAR_MARK',
                                    'MA5_C',
                                    'MA15_C',
                                    'MA30_C',
                                    'MA60_C',
                                    'GMMA3_C',
                                    'GMMA15_C',
                                    'GMMA30_C',
                                    'MA_VOL5_C',
                                    'MA_VOL60_C',
                                    'GMMA_VOL3_C',
                                    'GMMA_VOL15_C',
                                    'GMMA_VOL30_C',
                                    'MA5_D',
                                    'MA15_D',
                                    'MA30_D',
                                    'MA60_D',
                                    'GMMA3_D',
                                    'GMMA_VOL3_D',
                                    'GMMA15_D',
                                    'GMMA_VOL15_D',
                                    'GMMA30_D',
                                    'GMMA_VOL30_D',
                                    'SKDJ_TR',
                                    'SHORT_TR',
                                    'LONG_TR']
    QA_util_sql_store_mysql(data[index_col], "STOCK_TECH_NEUT",if_exists='append')
    QA_util_log_info(
        '##JOB ETL STOCK INDEX QUANT DATA NEUTRAL HAS BEEN SAVED ==== from {} to {}'.format(start_date, end_date), ui_log)
    index_week = ['date', 'code'] +  ['VR_WK',
                                      'VRSI_WK',
                                      'VRSI_C_WK',
                                      'VSTD_WK',
                                      'BOLL_WK',
                                      'UB_WK',
                                      'LB_WK',
                                      'WIDTH_WK',
                                      'WR_WK',
                                      'MR_WK',
                                      'SR_WK',
                                      'WS_WK',
                                      'MS_WK',
                                      'SS_WK',
                                      'MIKE_WRSC_WK',
                                      'MIKE_WRJC_WK',
                                      'MIKE_WSSC_WK',
                                      'MIKE_WSJC_WK',
                                      'MIKE_TR_WK',
                                      'MIKE_BOLL_WK',
                                      'ASI_WK',
                                      'ASIT_WK',
                                      'OBV_WK',
                                      'OBV_C_WK',
                                      'VPT_WK',
                                      'MAVPT_WK',
                                      'VPT_CROSS1_WK',
                                      'VPT_CROSS2_WK',
                                      'VPT_CROSS3_WK',
                                      'VPT_CROSS4_WK',
                                      'KDJ_K_WK',
                                      'KDJ_D_WK',
                                      'KDJ_J_WK',
                                      'KDJ_CROSS1_WK',
                                      'KDJ_CROSS2_WK',
                                      'WR1_WK',
                                      'WR2_WK',
                                      'WR_CROSS1_WK',
                                      'WR_CROSS2_WK',
                                      'ROC_WK',
                                      'ROCMA_WK',
                                      'RSI1_WK',
                                      'RSI2_WK',
                                      'RSI3_WK',
                                      'RSI1_C_WK',
                                      'RSI2_C_WK',
                                      'RSI3_C_WK',
                                      'RSI_CROSS1_WK',
                                      'RSI_CROSS2_WK',
                                      'CCI_WK',
                                      'CCI_CROSS1_WK',
                                      'CCI_CROSS2_WK',
                                      'CCI_CROSS3_WK',
                                      'CCI_CROSS4_WK',
                                      'BIAS1_WK',
                                      'BIAS2_WK',
                                      'BIAS3_WK',
                                      'BIAS_CROSS1_WK',
                                      'BIAS_CROSS2_WK',
                                      'OSC_WK',
                                      'MAOSC_WK',
                                      'OSC_CROSS1_WK',
                                      'OSC_CROSS2_WK',
                                      'OSC_CROSS3_WK',
                                      'OSC_CROSS4_WK',
                                      'ADTM_WK',
                                      'MAADTM_WK',
                                      'ADTM_CROSS1_WK',
                                      'ADTM_CROSS2_WK',
                                      'DIF_WK',
                                      'DEA_WK',
                                      'MACD_WK',
                                      'CROSS_JC_WK',
                                      'CROSS_SC_WK',
                                      'MACD_TR_WK',
                                      'DI1_WK',
                                      'DI2_WK',
                                      'ADX_WK',
                                      'ADXR_WK',
                                      'ADX_C_WK',
                                      'DI_M_WK',
                                      'DI_CROSS1_WK',
                                      'DI_CROSS2_WK',
                                      'ADX_CROSS1_WK',
                                      'ADX_CROSS2_WK',
                                      'DDD_WK',
                                      'AMA_WK',
                                      'DMA_CROSS1_WK',
                                      'DMA_CROSS2_WK',
                                      'MTM_WK',
                                      'MTMMA_WK',
                                      'MTM_CROSS1_WK',
                                      'MTM_CROSS2_WK',
                                      'MTM_CROSS3_WK',
                                      'MTM_CROSS4_WK',
                                      'BBI_WK',
                                      'BBI_CROSS1_WK',
                                      'BBI_CROSS2_WK',
                                      'MFI_WK',
                                      'MFI_C_WK',
                                      'TR_WK',
                                      'ATR_WK',
                                      'ATRR_WK',
                                      'RSV_WK',
                                      'SKDJ_K_WK',
                                      'SKDJ_D_WK',
                                      'SKDJ_CROSS1_WK',
                                      'SKDJ_CROSS2_WK',
                                      'DDI_WK',
                                      'ADDI_WK',
                                      'AD_WK',
                                      'DDI_C_WK',
                                      'AD_C_WK',
                                      'ADDI_C_WK',
                                      'SHA_LOW_WK',
                                      'SHA_UP_WK',
                                      'BODY_WK',
                                      'BODY_ABS_WK',
                                      'PRICE_PCG_WK',
                                      'MA3_WK',
                                      'MA5_WK',
                                      'MA8_WK',
                                      'MA10_WK',
                                      'MA12_WK',
                                      'MA15_WK',
                                      'MA20_WK',
                                      'MA30_WK',
                                      'MA35_WK',
                                      'MA40_WK',
                                      'MA45_WK',
                                      'MA50_WK',
                                      'MA60_WK',
                                      'SHORT10_WK',
                                      'SHORT20_WK',
                                      'SHORT60_WK',
                                      'LONG60_WK',
                                      'SHORT_CROSS1_WK',
                                      'SHORT_CROSS2_WK',
                                      'LONG_CROSS1_WK',
                                      'LONG_CROSS2_WK',
                                      'LONG_AMOUNT_WK',
                                      'SHORT_AMOUNT_WK',
                                      'GMMA3_WK',
                                      'GMMA5_WK',
                                      'GMMA8_WK',
                                      'GMMA10_WK',
                                      'GMMA12_WK',
                                      'GMMA30_WK',
                                      'GMMA35_WK',
                                      'GMMA40_WK',
                                      'GMMA45_WK',
                                      'GMMA50_WK',
                                      'MA_VOL3_WK',
                                      'MA_VOL5_WK',
                                      'MA_VOL8_WK',
                                      'MA_VOL10_WK',
                                      'MA_VOL12_WK',
                                      'MA_VOL15_WK',
                                      'MA_VOL20_WK',
                                      'MA_VOL30_WK',
                                      'MA_VOL35_WK',
                                      'MA_VOL40_WK',
                                      'MA_VOL45_WK',
                                      'MA_VOL50_WK',
                                      'MA_VOL60_WK',
                                      'SHORT10V_WK',
                                      'SHORT20V_WK',
                                      'SHORT60V_WK',
                                      'LONG60V_WK',
                                      'SHORTV_CROSS1_WK',
                                      'SHORTV_CROSS2_WK',
                                      'LONGV_CROSS1_WK',
                                      'LONGV_CROSS2_WK',
                                      'LONGV_AMOUNT_WK',
                                      'SHORTV_AMOUNT_WK',
                                      'GMMA_VOL3_WK',
                                      'GMMA_VOL5_WK',
                                      'GMMA_VOL8_WK',
                                      'GMMA_VOL10_WK',
                                      'GMMA_VOL12_WK',
                                      'GMMA_VOL30_WK',
                                      'GMMA_VOL35_WK',
                                      'GMMA_VOL40_WK',
                                      'GMMA_VOL45_WK',
                                      'GMMA_VOL50_WK',
                                      'CDL2CROWS_WK',
                                      'CDL3BLACKCROWS_WK',
                                      'CDL3INSIDE_WK',
                                      'CDL3LINESTRIKE_WK',
                                      'CDL3OUTSIDE_WK',
                                      'CDL3STARSINSOUTH_WK',
                                      'CDL3WHITESOLDIERS_WK',
                                      'CDLABANDONEDBABY_WK',
                                      'CDLADVANCEBLOCK_WK',
                                      'CDLBELTHOLD_WK',
                                      'CDLBREAKAWAY_WK',
                                      'CDLCLOSINGMARUBOZU_WK',
                                      'CDLCONCEALBABYSWALL_WK',
                                      'CDLCOUNTERATTACK_WK',
                                      'CDLDARKCLOUDCOVER_WK',
                                      'CDLDOJI_WK',
                                      'CDLDOJISTAR_WK',
                                      'CDLDRAGONFLYDOJI_WK',
                                      'CDLENGULFING_WK',
                                      'CDLEVENINGDOJISTAR_WK',
                                      'CDLEVENINGSTAR_WK',
                                      'CDLGAPSIDESIDEWHITE_WK',
                                      'CDLGRAVESTONEDOJI_WK',
                                      'CDLHAMMER_WK',
                                      'CDLHANGINGMAN_WK',
                                      'CDLHARAMI_WK',
                                      'CDLHARAMICROSS_WK',
                                      'CDLHIGHWAVE_WK',
                                      'CDLHIKKAKE_WK',
                                      'CDLHIKKAKEMOD_WK',
                                      'CDLHOMINGPIGEON_WK',
                                      'CDLIDENTICAL3CROWS_WK',
                                      'CDLINNECK_WK',
                                      'CDLINVERTEDHAMMER_WK',
                                      'CDLKICKING_WK',
                                      'CDLKICKINGBYLENGTH_WK',
                                      'CDLLADDERBOTTOM_WK',
                                      'CDLLONGLEGGEDDOJI_WK',
                                      'CDLLONGLINE_WK',
                                      'CDLMARUBOZU_WK',
                                      'CDLMATCHINGLOW_WK',
                                      'CDLMATHOLD_WK',
                                      'CDLMORNINGDOJISTAR_WK',
                                      'CDLMORNINGSTAR_WK',
                                      'CDLONNECK_WK',
                                      'CDLPIERCING_WK',
                                      'CDLRICKSHAWMAN_WK',
                                      'CDLRISEFALL3METHODS_WK',
                                      'CDLSEPARATINGLINES_WK',
                                      'CDLSHOOTINGSTAR_WK',
                                      'CDLSHORTLINE_WK',
                                      'CDLSPINNINGTOP_WK',
                                      'CDLSTALLEDPATTERN_WK',
                                      'CDLSTICKSANDWICH_WK',
                                      'CDLTAKURI_WK',
                                      'CDLTASUKIGAP_WK',
                                      'CDLTHRUSTING_WK',
                                      'CDLTRISTAR_WK',
                                      'CDLUNIQUE3RIVER_WK',
                                      'CDLUPSIDEGAP2CROWS_WK',
                                      'CDLXSIDEGAP3METHODS_WK',
                                      'SAR_MARK_WK',
                                      'MA5_C_WK',
                                      'MA15_C_WK',
                                      'MA30_C_WK',
                                      'MA60_C_WK',
                                      'GMMA3_C_WK',
                                      'GMMA15_C_WK',
                                      'GMMA30_C_WK',
                                      'MA_VOL5_C_WK',
                                      'MA_VOL60_C_WK',
                                      'GMMA_VOL3_C_WK',
                                      'GMMA_VOL15_C_WK',
                                      'GMMA_VOL30_C_WK',
                                      'MA5_D_WK',
                                      'MA15_D_WK',
                                      'MA30_D_WK',
                                      'MA60_D_WK',
                                      'GMMA3_D_WK',
                                      'GMMA_VOL3_D_WK',
                                      'GMMA15_D_WK',
                                      'GMMA_VOL15_D_WK',
                                      'GMMA30_D_WK',
                                      'GMMA_VOL30_D_WK',
                                      'SKDJ_TR_WK',
                                      'SHORT_TR_WK',
                                      'LONG_TR_WK']
    week_res = data[index_week]
    week_res.columns = index_col
    QA_util_sql_store_mysql(week_res, "STOCK_TECH_NEUT_WEEK",if_exists='append')
    QA_util_log_info(
        '##JOB ETL STOCK INDEX WEEK QUANT DATA NEUTRAL HAS BEEN SAVED ==== from {} to {}'.format(start_date, end_date), ui_log)
    index_hour = ['date', 'code'] + ['VR_HR',
                                     'VRSI_HR',
                                     'VRSI_C_HR',
                                     'VSTD_HR',
                                     'BOLL_HR',
                                     'UB_HR',
                                     'LB_HR',
                                     'WIDTH_HR',
                                     'WR_HR',
                                     'MR_HR',
                                     'SR_HR',
                                     'WS_HR',
                                     'MS_HR',
                                     'SS_HR',
                                     'MIKE_WRSC_HR',
                                     'MIKE_WRJC_HR',
                                     'MIKE_WSSC_HR',
                                     'MIKE_WSJC_HR',
                                     'MIKE_TR_HR',
                                     'MIKE_BOLL_HR',
                                     'ASI_HR',
                                     'ASIT_HR',
                                     'OBV_HR',
                                     'OBV_C_HR',
                                     'VPT_HR',
                                     'MAVPT_HR',
                                     'VPT_CROSS1_HR',
                                     'VPT_CROSS2_HR',
                                     'VPT_CROSS3_HR',
                                     'VPT_CROSS4_HR',
                                     'KDJ_K_HR',
                                     'KDJ_D_HR',
                                     'KDJ_J_HR',
                                     'KDJ_CROSS1_HR',
                                     'KDJ_CROSS2_HR',
                                     'WR1_HR',
                                     'WR2_HR',
                                     'WR_CROSS1_HR',
                                     'WR_CROSS2_HR',
                                     'ROC_HR',
                                     'ROCMA_HR',
                                     'RSI1_HR',
                                     'RSI2_HR',
                                     'RSI3_HR',
                                     'RSI1_C_HR',
                                     'RSI2_C_HR',
                                     'RSI3_C_HR',
                                     'RSI_CROSS1_HR',
                                     'RSI_CROSS2_HR',
                                     'CCI_HR',
                                     'CCI_CROSS1_HR',
                                     'CCI_CROSS2_HR',
                                     'CCI_CROSS3_HR',
                                     'CCI_CROSS4_HR',
                                     'BIAS1_HR',
                                     'BIAS2_HR',
                                     'BIAS3_HR',
                                     'BIAS_CROSS1_HR',
                                     'BIAS_CROSS2_HR',
                                     'OSC_HR',
                                     'MAOSC_HR',
                                     'OSC_CROSS1_HR',
                                     'OSC_CROSS2_HR',
                                     'OSC_CROSS3_HR',
                                     'OSC_CROSS4_HR',
                                     'ADTM_HR',
                                     'MAADTM_HR',
                                     'ADTM_CROSS1_HR',
                                     'ADTM_CROSS2_HR',
                                     'DIF_HR',
                                     'DEA_HR',
                                     'MACD_HR',
                                     'CROSS_JC_HR',
                                     'CROSS_SC_HR',
                                     'MACD_TR_HR',
                                     'DI1_HR',
                                     'DI2_HR',
                                     'ADX_HR',
                                     'ADXR_HR',
                                     'ADX_C_HR',
                                     'DI_M_HR',
                                     'DI_CROSS1_HR',
                                     'DI_CROSS2_HR',
                                     'ADX_CROSS1_HR',
                                     'ADX_CROSS2_HR',
                                     'DDD_HR',
                                     'AMA_HR',
                                     'DMA_CROSS1_HR',
                                     'DMA_CROSS2_HR',
                                     'MTM_HR',
                                     'MTMMA_HR',
                                     'MTM_CROSS1_HR',
                                     'MTM_CROSS2_HR',
                                     'MTM_CROSS3_HR',
                                     'MTM_CROSS4_HR',
                                     'BBI_HR',
                                     'BBI_CROSS1_HR',
                                     'BBI_CROSS2_HR',
                                     'MFI_HR',
                                     'MFI_C_HR',
                                     'TR_HR',
                                     'ATR_HR',
                                     'ATRR_HR',
                                     'RSV_HR',
                                     'SKDJ_K_HR',
                                     'SKDJ_D_HR',
                                     'SKDJ_CROSS1_HR',
                                     'SKDJ_CROSS2_HR',
                                     'DDI_HR',
                                     'ADDI_HR',
                                     'AD_HR',
                                     'DDI_C_HR',
                                     'AD_C_HR',
                                     'ADDI_C_HR',
                                     'SHA_LOW_HR',
                                     'SHA_UP_HR',
                                     'BODY_HR',
                                     'BODY_ABS_HR',
                                     'PRICE_PCG_HR',
                                     'MA3_HR',
                                     'MA5_HR',
                                     'MA8_HR',
                                     'MA10_HR',
                                     'MA12_HR',
                                     'MA15_HR',
                                     'MA20_HR',
                                     'MA30_HR',
                                     'MA35_HR',
                                     'MA40_HR',
                                     'MA45_HR',
                                     'MA50_HR',
                                     'MA60_HR',
                                     'SHORT10_HR',
                                     'SHORT20_HR',
                                     'SHORT60_HR',
                                     'LONG60_HR',
                                     'SHORT_CROSS1_HR',
                                     'SHORT_CROSS2_HR',
                                     'LONG_CROSS1_HR',
                                     'LONG_CROSS2_HR',
                                     'LONG_AMOUNT_HR',
                                     'SHORT_AMOUNT_HR',
                                     'GMMA3_HR',
                                     'GMMA5_HR',
                                     'GMMA8_HR',
                                     'GMMA10_HR',
                                     'GMMA12_HR',
                                     'GMMA30_HR',
                                     'GMMA35_HR',
                                     'GMMA40_HR',
                                     'GMMA45_HR',
                                     'GMMA50_HR',
                                     'MA_VOL3_HR',
                                     'MA_VOL5_HR',
                                     'MA_VOL8_HR',
                                     'MA_VOL10_HR',
                                     'MA_VOL12_HR',
                                     'MA_VOL15_HR',
                                     'MA_VOL20_HR',
                                     'MA_VOL30_HR',
                                     'MA_VOL35_HR',
                                     'MA_VOL40_HR',
                                     'MA_VOL45_HR',
                                     'MA_VOL50_HR',
                                     'MA_VOL60_HR',
                                     'SHORT10V_HR',
                                     'SHORT20V_HR',
                                     'SHORT60V_HR',
                                     'LONG60V_HR',
                                     'SHORTV_CROSS1_HR',
                                     'SHORTV_CROSS2_HR',
                                     'LONGV_CROSS1_HR',
                                     'LONGV_CROSS2_HR',
                                     'LONGV_AMOUNT_HR',
                                     'SHORTV_AMOUNT_HR',
                                     'GMMA_VOL3_HR',
                                     'GMMA_VOL5_HR',
                                     'GMMA_VOL8_HR',
                                     'GMMA_VOL10_HR',
                                     'GMMA_VOL12_HR',
                                     'GMMA_VOL30_HR',
                                     'GMMA_VOL35_HR',
                                     'GMMA_VOL40_HR',
                                     'GMMA_VOL45_HR',
                                     'GMMA_VOL50_HR',
                                     'CDL2CROWS_HR',
                                     'CDL3BLACKCROWS_HR',
                                     'CDL3INSIDE_HR',
                                     'CDL3LINESTRIKE_HR',
                                     'CDL3OUTSIDE_HR',
                                     'CDL3STARSINSOUTH_HR',
                                     'CDL3WHITESOLDIERS_HR',
                                     'CDLABANDONEDBABY_HR',
                                     'CDLADVANCEBLOCK_HR',
                                     'CDLBELTHOLD_HR',
                                     'CDLBREAKAWAY_HR',
                                     'CDLCLOSINGMARUBOZU_HR',
                                     'CDLCONCEALBABYSWALL_HR',
                                     'CDLCOUNTERATTACK_HR',
                                     'CDLDARKCLOUDCOVER_HR',
                                     'CDLDOJI_HR',
                                     'CDLDOJISTAR_HR',
                                     'CDLDRAGONFLYDOJI_HR',
                                     'CDLENGULFING_HR',
                                     'CDLEVENINGDOJISTAR_HR',
                                     'CDLEVENINGSTAR_HR',
                                     'CDLGAPSIDESIDEWHITE_HR',
                                     'CDLGRAVESTONEDOJI_HR',
                                     'CDLHAMMER_HR',
                                     'CDLHANGINGMAN_HR',
                                     'CDLHARAMI_HR',
                                     'CDLHARAMICROSS_HR',
                                     'CDLHIGHWAVE_HR',
                                     'CDLHIKKAKE_HR',
                                     'CDLHIKKAKEMOD_HR',
                                     'CDLHOMINGPIGEON_HR',
                                     'CDLIDENTICAL3CROWS_HR',
                                     'CDLINNECK_HR',
                                     'CDLINVERTEDHAMMER_HR',
                                     'CDLKICKING_HR',
                                     'CDLKICKINGBYLENGTH_HR',
                                     'CDLLADDERBOTTOM_HR',
                                     'CDLLONGLEGGEDDOJI_HR',
                                     'CDLLONGLINE_HR',
                                     'CDLMARUBOZU_HR',
                                     'CDLMATCHINGLOW_HR',
                                     'CDLMATHOLD_HR',
                                     'CDLMORNINGDOJISTAR_HR',
                                     'CDLMORNINGSTAR_HR',
                                     'CDLONNECK_HR',
                                     'CDLPIERCING_HR',
                                     'CDLRICKSHAWMAN_HR',
                                     'CDLRISEFALL3METHODS_HR',
                                     'CDLSEPARATINGLINES_HR',
                                     'CDLSHOOTINGSTAR_HR',
                                     'CDLSHORTLINE_HR',
                                     'CDLSPINNINGTOP_HR',
                                     'CDLSTALLEDPATTERN_HR',
                                     'CDLSTICKSANDWICH_HR',
                                     'CDLTAKURI_HR',
                                     'CDLTASUKIGAP_HR',
                                     'CDLTHRUSTING_HR',
                                     'CDLTRISTAR_HR',
                                     'CDLUNIQUE3RIVER_HR',
                                     'CDLUPSIDEGAP2CROWS_HR',
                                     'CDLXSIDEGAP3METHODS_HR',
                                     'SAR_MARK_HR',
                                     'MA5_C_HR',
                                     'MA15_C_HR',
                                     'MA30_C_HR',
                                     'MA60_C_HR',
                                     'GMMA3_C_HR',
                                     'GMMA15_C_HR',
                                     'GMMA30_C_HR',
                                     'MA_VOL5_C_HR',
                                     'MA_VOL60_C_HR',
                                     'GMMA_VOL3_C_HR',
                                     'GMMA_VOL15_C_HR',
                                     'GMMA_VOL30_C_HR',
                                     'MA5_D_HR',
                                     'MA15_D_HR',
                                     'MA30_D_HR',
                                     'MA60_D_HR',
                                     'GMMA3_D_HR',
                                     'GMMA_VOL3_D_HR',
                                     'GMMA15_D_HR',
                                     'GMMA_VOL15_D_HR',
                                     'GMMA30_D_HR',
                                     'GMMA_VOL30_D_HR',
                                     'SKDJ_TR_HR',
                                     'SHORT_TR_HR',
                                     'LONG_TR_HR']
    hour_res = data[index_hour]
    hour_res.columns = index_col
    QA_util_sql_store_mysql(hour_res, "STOCK_TECH_NEUT_HOUR",if_exists='append')
    QA_util_log_info(
        '##JOB ETL STOCK INDEX HOUR QUANT DATA NEUTRAL HAS BEEN SAVED ==== from {} to {}'.format(start_date, end_date), ui_log)
    aplha_col = ['date', 'code'] + ['ALPHA_001',
                                    'ALPHA_002',
                                    'ALPHA_003',
                                    'ALPHA_004',
                                    'ALPHA_005',
                                    'ALPHA_006',
                                    'ALPHA_007',
                                    'ALPHA_008',
                                    'ALPHA_009',
                                    'ALPHA_010',
                                    'ALPHA_011',
                                    'ALPHA_012',
                                    'ALPHA_013',
                                    'ALPHA_014',
                                    'ALPHA_015',
                                    'ALPHA_016',
                                    'ALPHA_018',
                                    'ALPHA_019',
                                    'ALPHA_020',
                                    'ALPHA_021',
                                    'ALPHA_022',
                                    'ALPHA_023',
                                    'ALPHA_024',
                                    'ALPHA_025',
                                    'ALPHA_026',
                                    'ALPHA_028',
                                    'ALPHA_029',
                                    'ALPHA_031',
                                    'ALPHA_032',
                                    'ALPHA_033',
                                    'ALPHA_034',
                                    'ALPHA_035',
                                    'ALPHA_036',
                                    'ALPHA_037',
                                    'ALPHA_038',
                                    'ALPHA_039',
                                    'ALPHA_040',
                                    'ALPHA_041',
                                    'ALPHA_042',
                                    'ALPHA_043',
                                    'ALPHA_044',
                                    'ALPHA_045',
                                    'ALPHA_046',
                                    'ALPHA_047',
                                    'ALPHA_048',
                                    'ALPHA_049',
                                    'ALPHA_052',
                                    'ALPHA_053',
                                    'ALPHA_054',
                                    'ALPHA_056',
                                    'ALPHA_057',
                                    'ALPHA_058',
                                    'ALPHA_059',
                                    'ALPHA_060',
                                    'ALPHA_061',
                                    'ALPHA_062',
                                    'ALPHA_063',
                                    'ALPHA_064',
                                    'ALPHA_065',
                                    'ALPHA_066',
                                    'ALPHA_067',
                                    'ALPHA_068',
                                    'ALPHA_070',
                                    'ALPHA_071',
                                    'ALPHA_072',
                                    'ALPHA_074',
                                    'ALPHA_076',
                                    'ALPHA_077',
                                    'ALPHA_078',
                                    'ALPHA_079',
                                    'ALPHA_080',
                                    'ALPHA_081',
                                    'ALPHA_082',
                                    'ALPHA_083',
                                    'ALPHA_084',
                                    'ALPHA_085',
                                    'ALPHA_086',
                                    'ALPHA_087',
                                    'ALPHA_088',
                                    'ALPHA_089',
                                    'ALPHA_090',
                                    'ALPHA_091',
                                    'ALPHA_093',
                                    'ALPHA_094',
                                    'ALPHA_095',
                                    'ALPHA_096',
                                    'ALPHA_097',
                                    'ALPHA_098',
                                    'ALPHA_099',
                                    'ALPHA_100',
                                    'ALPHA_101',
                                    'ALPHA_102',
                                    'ALPHA_103',
                                    'ALPHA_104',
                                    'ALPHA_105',
                                    'ALPHA_106',
                                    'ALPHA_107',
                                    'ALPHA_108',
                                    'ALPHA_109',
                                    'ALPHA_111',
                                    'ALPHA_112',
                                    'ALPHA_114',
                                    'ALPHA_115',
                                    'ALPHA_117',
                                    'ALPHA_118',
                                    'ALPHA_119',
                                    'ALPHA_120',
                                    'ALPHA_122',
                                    'ALPHA_123',
                                    'ALPHA_124',
                                    'ALPHA_125',
                                    'ALPHA_126',
                                    'ALPHA_127',
                                    'ALPHA_128',
                                    'ALPHA_129',
                                    'ALPHA_130',
                                    'ALPHA_132',
                                    'ALPHA_133',
                                    'ALPHA_134',
                                    'ALPHA_135',
                                    'ALPHA_136',
                                    'ALPHA_137',
                                    'ALPHA_139',
                                    'ALPHA_141',
                                    'ALPHA_142',
                                    'ALPHA_145',
                                    'ALPHA_148',
                                    'ALPHA_150',
                                    'ALPHA_152',
                                    'ALPHA_153',
                                    'ALPHA_154',
                                    'ALPHA_155',
                                    'ALPHA_156',
                                    'ALPHA_157',
                                    'ALPHA_158',
                                    'ALPHA_159',
                                    'ALPHA_160',
                                    'ALPHA_161',
                                    'ALPHA_162',
                                    'ALPHA_163',
                                    'ALPHA_164',
                                    'ALPHA_167',
                                    'ALPHA_168',
                                    'ALPHA_169',
                                    'ALPHA_170',
                                    'ALPHA_172',
                                    'ALPHA_173',
                                    'ALPHA_174',
                                    'ALPHA_175',
                                    'ALPHA_177',
                                    'ALPHA_178',
                                    'ALPHA_179',
                                    'ALPHA_180',
                                    'ALPHA_184',
                                    'ALPHA_185',
                                    'ALPHA_186',
                                    'ALPHA_187',
                                    'ALPHA_188',
                                    'ALPHA_189',
                                    'ALPHA_191']
    QA_util_sql_store_mysql(data[aplha_col], "STOCK_ALPHA191_NEUT",if_exists='append')
    QA_util_log_info(
        '##JOB ETL STOCK ALPHA QUANT DATA NEUTRAL HAS BEEN SAVED ==== from {} to {}'.format(start_date, end_date), ui_log)
    fi_col = ['date', 'code'] + [
        'TRA_RATE',
        'STOCK_TYPE',
        'DAYS',
        'AVG5',
        'AVG10',
        'AVG20',
        'AVG30',
        'AVG60',
        'LAG',
        'LAG2',
        'LAG3',
        'LAG5',
        'LAG10',
        'LAG20',
        'LAG30',
        'LAG60',
        'AVG5_TOR',
        'AVG20_TOR',
        'AVG30_TOR',
        'AVG60_TOR',
        'GROSSMARGIN',
        'NETPROFIT_INRATE',
        'OPERATINGRINRATE',
        'NETCASHOPERATINRATE',
        'PB',
        'PBG',
        'PC',
        'PE_TTM',
        'PEEGL_TTM',
        'PEG',
        'PM',
        'PS',
        'PSG',
        'PT',
        'PE_RATE',
        'PEEGL_RATE',
        'PB_RATE',
        'ROE_RATE',
        'ROE_TTM',
        'ROA_RATE',
        'GROSS_RATE',
        'RNG',
        'RNG_L',
        'RNG_5',
        'RNG_10',
        'RNG_20',
        'RNG_30',
        'RNG_60',
        'RNG_90',
        'AMT_L',
        'AMT_5',
        'AMT_10',
        'AMT_20',
        'AMT_30',
        'AMT_60',
        'AMT_90',
        'MAMT_5',
        'MAMT_10',
        'MAMT_20',
        'MAMT_30',
        'MAMT_60',
        'MAMT_90',
        'NEG5_RT',
        'NEG5_RATE',
        'NEG10_RT',
        'NEG10_RATE',
        'NEG20_RT',
        'NEG20_RATE',
        'NEG30_RT',
        'NEG30_RATE',
        'NEG60_RT',
        'NEG60_RATE',
        'NEG90_RT',
        'NEG90_RATE',
        'AVG5_RNG',
        'AVG10_RNG',
        'AVG20_RNG',
        'AVG30_RNG',
        'AVG60_RNG',
        'ROA',
        'ROE',
        'AVG5_CR',
        'AVG10_CR',
        'AVG20_CR',
        'AVG30_CR',
        'AVG60_CR',
        'AVG5_TR',
        'AVG10_TR',
        'AVG20_TR',
        'AVG30_TR',
        'AVG60_TR',
        'TOTALPROFITINRATE',
        'AVG10_C_MARKET',
        'AVG20_C_MARKET',
        'AVG60_C_MARKET']
    QA_util_sql_store_mysql(data[fi_col], "STOCK_FINANCIAL_NEUT",if_exists='append')
    QA_util_log_info(
        '##JOB ETL STOCK FINANCIAL QUANT DATA NEUTRAL HAS BEEN SAVED ==== from {} to {}'.format(start_date, end_date), ui_log)
    pe_col = ['date', 'code'] + ['PE_30VAL','PE_30DN','PE_30UP',
                                 'PEEGL_30VAL','PEEGL_30DN','PEEGL_30UP',
                                 'PB_30VAL','PB_30DN','PB_30UP',
                                 'PS_30VAL','PS_30DN','PS_30UP',
                                 'PE_60VAL','PE_60DN','PE_60UP',
                                 'PEEGL_60VAL','PEEGL_60DN','PEEGL_60UP',
                                 'PB_60VAL','PB_60DN','PB_60UP',
                                 'PS_60VAL','PS_60DN','PS_60UP',
                                 'PE_90VAL','PE_90DN','PE_90UP',
                                 'PEEGL_90VAL','PEEGL_90DN','PEEGL_90UP',
                                 'PB_90VAL','PB_90DN','PB_90UP'
                                 ]
    QA_util_sql_store_mysql(data[pe_col], "STOCK_FINANCIAL_PERCENT_NEUT",if_exists='append')
    QA_util_log_info(
        '##JOB ETL STOCK PE QUANT DATA NEUTRAL HAS BEEN SAVED ==== from {} to {}'.format(start_date, end_date), ui_log)
    QA_util_log_info(
        '##JOB ETL STOCK QUANT DATA NEUTRAL HAS BEEN SAVED ==== from {} to {}'.format(start_date, end_date), ui_log)